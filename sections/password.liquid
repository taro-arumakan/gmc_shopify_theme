{%- liquid
  assign login_button_t = "layout.password.login_button" | t
  assign login_cancel_t = "layout.password.login_cancel" | t
  assign login_link_t = "layout.password.login_link" | t
  assign login_title_t = "layout.password.login_title" | t
  assign shopify_info_t = "layout.password.shopify_info" | t
  assign subtitle_t = "layout.password.sub_title" | t
  assign title_t = "layout.password.title" | t

  assign show_mailing = section.settings.show-mailing-list
  assign logo = section.settings.logo
  assign logo_height = section.settings.logo-height
  assign mobile_logo_height = section.settings.mobile-logo-height
-%}

{%- capture shopify -%}
  <a
    class="shopify-link"
    href="https://www.shopify.com"
    aria-label="{{ shopify_info_t }}"
    rel="noreferrer">
    {% render 'icons', icon: 'shopify' %}
    <span data-item="hidden-text">Shopify</span>
  </a>
{%- endcapture -%}

<password-element
  class="password--root"
  style="background-image:url('{{ 'password-page-background.jpg' | asset_url }}');"
  data-section-id="{{ section.id }}"
  data-section-type="password"
  data-mobile-spacing-above="large"
  data-mobile-spacing-below="large"
  data-show-login="false"
  data-spacing-above="large"
  data-spacing-below="large"
  data-text-color="white"
>
  <button class="password--login" data-item="block-link">
    <span>
      {%- render 'icons', icon: 'lock' -%}
      {{ login_link_t }}
    </span>
  </button>

  <div class="password--container">
    {%- form 'storefront_password', id: 'password_form', class: 'password--form' -%}
      <div class="password--errors" data-item="paragraph" data-text-color="alert">
        {{- form.errors | default_errors -}}
      </div>
      <label data-item="nav-text" for="password">
        {{- login_title_t -}}
      </label>

      <input
        type="password"
        id="password"
        name="password"
        autocomplete="password"
      >

      <div class="password--buttons-container">
        <button
          class="password--button"
          data-item="button-1"
          data-text="{{ login_button_t | capitalize }}"
        >
          <span>{{ login_button_t | capitalize }}</span>
        </button>

        <button type="button" class="password--cancel" data-item="block-link">
          <span>
            {{- login_cancel_t -}}
          </span>
        </button>
      </div>
    {%- endform -%}

    <div class="password--main">
      <div class="password--logo">
        {%-
          render 'logo',
          logo: logo,
          height: logo_height,
          mobile_height: mobile_logo_height
        -%}
      </div>

      <h2 class="password--subtitle" data-item="section-heading">
        {{- title_t -}}
      </h2>

      <p class="password--info" data-item="paragraph">
        {%- liquid
          if shop.password_message != blank
            echo shop.password_message
          else
            echo subtitle_t
          endif
        -%}
      </p>

      {%- if show_mailing -%}
        {%- if section.settings.mailing-list--title != blank -%}
          <div class="password--mailing-header" data-item="block-heading">
            {{ section.settings.mailing-list--title }}
          </div>
        {%- endif -%}

        <div class="password--mailing-list" id="newsletter">
          {%-
            render 'subscribe-form',
            id: 'customer_form',
            alignment: 'center',
            mobile_alignment: 'center'
          -%}
        </div>
      {%- endif -%}

      <div class="password--powered-by" data-item="paragraph">
        {{- 'layout.password.powered_by_shopify_html' | t: shopify: shopify -}}
      </div>
    </div>
  </div>
</password-element>

{% schema %}
{
  "name": "Password page",
  "class": "section--password",
  "settings": [
    {
      "type": "image_picker",
      "id": "logo",
      "label": "Logo image",
      "info": "Using a light colored logo is preferable since dark ones wonâ€™t be visible on the dark background."
    },
    {
      "label": "Custom logo height",
      "id": "logo-height",
      "type": "range",
      "min": 30,
      "max": 250,
      "step": 20,
      "unit": "px",
      "default": 50,
      "info": "This is referring to the natural height and should be half the height of the image you uploaded to ensure it stays sharp on retina screens."
    },
    {
      "label": "Mobile logo height",
      "id": "mobile-logo-height",
      "type": "range",
      "min": 30,
      "max": 250,
      "step": 20,
      "unit": "px",
      "default": 50
    },
    {
      "type": "header",
      "content": "Mailing list"
    },
    {
      "type": "checkbox",
      "id": "show-mailing-list",
      "label": "Show form",
      "default": true
    },
    {
      "id": "mailing-list--title",
      "label": "Heading",
      "type": "textarea",
      "default": "Sign up to our mailing list"
    }
  ]
}
{% endschema %}