{%- liquid
  assign bg_color = section.settings.background-color
  assign bg_image = section.settings.background-image
  assign border = section.settings.border
  assign container_width = section.settings.container-width
  assign mobile_image = section.settings.mobile-image
  assign mobile_spacing_above = section.settings.mobile-spacing-above
  assign mobile_spacing_below = section.settings.mobile-spacing-below
  assign mobile_text_alignment = section.settings.mobile-text-alignment
  assign outer_background = section.settings.outer-background
  assign overlay_style = section.settings.overlay-style
  assign parallax_enabled = section.settings.parallax-enabled
  assign reverse_layout = section.settings.reverse-layout
  assign spacing_above = section.settings.spacing-above
  assign spacing_below = section.settings.spacing-below
  assign text_alignment = section.settings.text-alignment
  assign text_style = section.settings.text-style
  assign white_text = section.settings.white-text

  assign columns = 1
  if section.blocks.size > 0
    assign columns = 2
  endif
-%}

<div
  class="countdown--root"
  data-section-id="{{ section.id }}"
  data-background-color="{{ bg_color }}"
  data-border="{{ border }}"
  data-container-width="{{ container_width }}"
  data-countdown-container
  data-mobile-spacing-above="{{ mobile_spacing_above }}"
  data-mobile-spacing-below="{{ mobile_spacing_below }}"
  data-outer-background="{{ outer_background }}"
  data-spacing-above="{{ spacing_above }}"
  data-spacing-below="{{ spacing_below }}"
>
  <div
    class="countdown--wrapper"
    data-container="panel"
    data-columns="{{ columns }}"
    data-mobile-columns="{{ mobile_columns }}"
    data-reverse-layout="{{ reverse_layout }}"
    {% if white_text %}
      data-text-color="white"
    {% endif %}
  >
    {%- if columns == 2 -%}
      {%-
        render 'section-blocks',
        section: section,
        mobile_x_alignment: mobile_text_alignment,
        text_style: text_style,
        x_alignment: text_alignment
      -%}
    {%- endif -%}

    {%-
      render 'countdown-timer',
      expiry_date: section.settings.expiry-date,
      expiry_hours: section.settings.expiry-hours,
      expiry_minutes: section.settings.expiry-minutes,
      light_number: section.settings.light-number,
      hide_when_expired: section.settings.hide-when-expired,
      show_button_when: section.settings.show-button-when,
      number_size: section.settings.number-size,
      mobile_number_size: section.settings.mobile-number-size,
      timer_bg_color: section.settings.timer-bg-color
    -%}

    {%- if bg_image -%}
      {%-
        render 'image',
        image: bg_image,
        background: true,
        overlay_style: overlay_style,
        mobile_overlay_style: overlay_style,
        mobile_image: mobile_image,
        parallax: parallax_enabled
      -%}
    {%- endif -%}
  </div>
</div>

{% schema %}
{
  "name": "Countdown",
  "class": "section--countdown",
  "settings": [
    {
      "type": "header",
      "content": "Style and layout"
    },
    {
      "id": "border",
      "label": "Border",
      "type": "select",
      "options": [
        {
          "label": "Top",
          "value": "top"
        },
        {
          "label": "Bottom",
          "value": "bottom"
        },
        {
          "label": "Both",
          "value": "both"
        },
        {
          "label": "None",
          "value": "none"
        }
      ],
      "default": "none"
    },
    {
      "id": "spacing-above",
      "label": "Spacing above",
      "type": "select",
      "options": [
        {
          "label": "None",
          "value": "none"
        },
        {
          "label": "Small",
          "value": "small"
        },
        {
          "label": "Medium",
          "value": "medium"
        },
        {
          "label": "Large",
          "value": "large"
        },
        {
          "label": "Extra large",
          "value": "x-large"
        }
      ],
      "default": "large"
    },
    {
      "id": "spacing-below",
      "label": "Spacing below",
      "type": "select",
      "options": [
        {
          "label": "None",
          "value": "none"
        },
        {
          "label": "Small",
          "value": "small"
        },
        {
          "label": "Medium",
          "value": "medium"
        },
        {
          "label": "Large",
          "value": "large"
        },
        {
          "label": "Extra large",
          "value": "x-large"
        }
      ],
      "default": "large"
    },
    {
      "id": "container-width",
      "label": "Maximum width of container",
      "type": "select",
      "options": [
        { "label": "Extra small", "value": "1" },
        { "label": "Small", "value": "2" },
        { "label": "Medium", "value": "3" },
        { "label": "Large", "value": "4" }
      ],
      "default": "3"
    },
    {
      "id": "background-color",
      "label": "Background color",
      "type": "select",
      "options": [
        {
          "label": "None",
          "value": "none"
        },
        {
          "label": "Light",
          "value": "light"
        },
        {
          "label": "Dark",
          "value": "dark"
        },
        {
          "label": "Accent 1",
          "value": "accent-1"
        },
        {
          "label": "Accent 2",
          "value": "accent-2"
        },
        {
          "label": "Accent 3",
          "value": "accent-3"
        }
      ],
      "default": "light"
    },
    {
      "id": "outer-background",
      "label": "Outer background",
      "type": "checkbox",
      "default": true
    },
    {
      "id": "reverse-layout",
      "label": "Reverse layout",
      "type": "checkbox",
      "default": false
    },
    {
      "id": "text-alignment",
      "label": "Text alignment",
      "type": "text_alignment",
      "default": "left"
    },
    {
      "id": "white-text",
      "label": "Use white text color",
      "type": "checkbox",
      "default": false
    },
    {
      "id": "text-style",
      "label": "Text shadows",
      "type": "select",
      "options": [
        {
          "label": "None",
          "value": "none"
        },
        {
          "label": "Text shadow",
          "value": "text-shadow"
        },
        {
          "label": "Oval shadow",
          "value": "eclipse-shadow"
        }
      ],
      "default": "none"
    },
    {
      "id": "background-image",
      "type": "image_picker",
      "label": "Background image"
    },
    {
      "id": "overlay-style",
      "label": "Image darkness",
      "type": "select",
      "options": [
        {
          "label": "None",
          "value": "none"
        },
        {
          "label": "Darken entire image",
          "value": "darken"
        },
        {
          "label": "Darken top down",
          "value": "darken-top"
        },
        {
          "label": "Darken bottom up",
          "value": "darken-bottom"
        }
      ],
      "default": "darken-bottom",
      "info": "Can enhance text visibility",
      "visible_if": "{{ section.settings.background-image != blank }}"
    },
    {
      "id": "parallax-enabled",
      "label": "Enable parallax",
      "type": "checkbox",
      "default": false,
      "info": "Creates a subtle depth effect on scroll, making images engaging",
      "visible_if": "{{ section.settings.background-image != blank }}"
    },
    {
      "id": "timer-bg-color",
      "label": "Timer background color",
      "type": "select",
      "options": [
        { "label": "None", "value": "none" },
        { "label": "Light", "value": "light" },
        { "label": "Dark", "value": "dark" }
      ],
      "default": "dark"
    },
    {
      "id": "light-number",
      "label": "Use light number color",
      "type": "checkbox",
      "default": true
    },
    {
      "id": "number-size",
      "label": "Number text size",
      "type": "range",
      "min": 20,
      "max": 60,
      "step": 1,
      "default": 40,
      "unit": "px"
    },
    {
      "type": "header",
      "content": "Features"
    },
    {
      "id": "expiry-date",
      "label": "Expiry date",
      "type": "text",
      "default": "DD-MM-YYYY",
      "info": "DD-MM-YYYY"
    },
    {
      "label": "Expiry hours",
      "id": "expiry-hours",
      "type": "range",
      "min": 0,
      "max": 23,
      "step": 1,
      "default": 0,
      "info": "Represents the hour in UTC standard time"
    },
    {
      "label": "Expiry minutes",
      "id": "expiry-minutes",
      "type": "range",
      "min": 0,
      "max": 59,
      "step": 1,
      "default": 0,
      "info": "Represents the minutes in UTC standard time"
    },
    {
      "id": "hide-when-expired",
      "label": "Hide section when countdown expires",
      "type": "checkbox",
      "default": true
    },
    {
      "type": "select",
      "id": "show-button-when",
      "label": "Show button when",
      "options": [
        { "label": "Timer is active", "value": "active" },
        { "label": "Timer reaches zero", "value": "finished" },
        { "label": "Always", "value": "always" }
      ],
      "default": "always"
    },
    {
      "type": "header",
      "content": "Mobile"
    },
    {
      "id": "mobile-spacing-above",
      "label": "Spacing above",
      "type": "select",
      "options": [
        {
          "label": "None",
          "value": "none"
        },
        {
          "label": "Small",
          "value": "small"
        },
        {
          "label": "Medium",
          "value": "medium"
        },
        {
          "label": "Large",
          "value": "large"
        },
        {
          "label": "Extra large",
          "value": "x-large"
        }
      ],
      "default": "medium"
    },
    {
      "id": "mobile-spacing-below",
      "label": "Spacing below",
      "type": "select",
      "options": [
        {
          "label": "None",
          "value": "none"
        },
        {
          "label": "Small",
          "value": "small"
        },
        {
          "label": "Medium",
          "value": "medium"
        },
        {
          "label": "Large",
          "value": "large"
        },
        {
          "label": "Extra large",
          "value": "x-large"
        }
      ],
      "default": "medium"
    },
    {
      "id": "mobile-text-alignment",
      "label": "Text alignment",
      "type": "text_alignment",
      "default": "center"
    },
    {
      "type": "image_picker",
      "id": "mobile-image",
      "label": "Mobile background image (optional)",
      "visible_if": "{{ section.settings.background-image != blank }}"
    },
    {
      "id": "mobile-number-size",
      "label": "Mobile number text size",
      "type": "range",
      "min": 12,
      "max": 24,
      "step": 1,
      "default": 20,
      "unit": "px"
    }
  ],
  "blocks": [
    {
      "type": "overline",
      "name": "Overline",
      "settings": [
        {
          "id": "overline",
          "label": "Overline",
          "type": "text",
          "default": "Overline text"
        }
      ]
    },
    {
      "type": "heading",
      "name": "Heading",
      "settings": [
        {
          "id": "heading-type",
          "label": "Heading type",
          "type": "select",
          "options": [
            { "label": "Banner", "value": "banner-heading" },
            { "label": "Featured", "value": "featured-heading" },
            { "label": "Large", "value": "section-heading" },
            { "label": "Medium", "value": "block-heading" }
          ],
          "default": "section-heading"
        },
        {
          "id": "title",
          "label": "Heading",
          "type": "text",
          "default": "Limited offer",
          "info": "Highlight headings by wrapping text with square brackets, ie. This is [highlighted]."
        },
        {
          "id": "highlight-type",
          "label": "Highlight type",
          "type": "select",
          "options": [
            {
              "label": "Italic",
              "value": "italic"
            },
            {
              "label": "Bold",
              "value": "bold"
            },
            {
              "label": "Bold italic",
              "value": "bold-italic"
            },
            {
              "label": "Text color",
              "value": "color"
            },
            {
              "label": "Outlined",
              "value": "outlined"
            },
            {
              "label": "Highlight",
              "value": "highlight"
            },
            {
              "label": "Half highlight",
              "value": "half-highlight"
            },
            {
              "label": "Underline",
              "value": "underline"
            },
            {
              "label": "Reverse opacity",
              "value": "reverse-opacity"
            }
          ],
          "default": "italic"
        },
        {
          "id": "highlight-color",
          "label": "Highlight color",
          "type": "select",
          "options": [
            {
              "label": "Transparent",
              "value": "transparent"
            },
            {
              "label": "Light",
              "value": "light"
            },
            {
              "label": "Dark",
              "value": "dark"
            },
            {
              "label": "Accent 1",
              "value": "accent-1"
            },
            {
              "label": "Accent 2",
              "value": "accent-2"
            },
            {
              "label": "Accent 3",
              "value": "accent-3"
            }
          ],
          "default": "accent-2"
        },
        {
          "id": "highlight-text",
          "label": "Highlighted text color",
          "type": "select",
          "options": [
            {
              "label": "None",
              "value": "none"
            },
            {
              "label": "Light",
              "value": "light"
            },
            {
              "label": "Dark",
              "value": "dark"
            },
            {
              "label": "Accent 1",
              "value": "accent-1"
            },
            {
              "label": "Accent 2",
              "value": "accent-2"
            },
            {
              "label": "Accent 3",
              "value": "accent-3"
            }
          ],
          "default": "none"
        }
      ]
    },
    {
      "type": "description",
      "name": "Description",
      "settings": [
        {
          "id": "description",
          "label": "Description",
          "type": "richtext",
          "default": "<p>Share something about a limited offer or temporary promotion.</p>"
        },
        {
          "id": "description-type",
          "label": "Description type",
          "type": "select",
          "options": [
            { "label": "Paragraph", "value": "paragraph" },
            { "label": "Featured", "value": "featured-paragraph" }
          ],
          "default": "paragraph"
        },
        {
          "id": "mobile-hide-enabled",
          "label": "Hide in mobile",
          "type": "checkbox",
          "default": false
        }
      ]
    },
    {
      "type": "button",
      "name": "Button",
      "settings": [
        {
          "id": "style",
          "label": "Style",
          "type": "select",
          "options": [
            { "label": "Style 1", "value": "button-1" },
            { "label": "Style 2", "value": "button-2" },
            { "label": "Style 3", "value": "button-3" },
            { "label": "Style 4", "value": "button-4" },
            { "label": "Link", "value": "block-link" }
          ],
          "default": "button-2"
        },
        {
          "id": "link-url",
          "label": "Link",
          "type": "url"
        },
        {
          "id": "link-text",
          "label": "Text",
          "type": "text",
          "default": "Text"
        }
      ],
      "limit": 1
    },
    {
      "type": "custom-liquid",
      "name": "Custom liquid",
      "settings": [
        {
          "type": "liquid",
          "id": "custom-liquid",
          "label": "Custom Liquid",
          "info": "Add app snippets or other Liquid code to create advanced customizations."
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Countdown",
      "blocks": [
        { "type": "overline" },
        { "type": "heading" },
        { "type": "description" },
        { "type": "button" }
      ]
    }
  ],
  "disabled_on": {
    "groups": ["aside"]
  }
}
{% endschema %}